{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "id": "#root",

    "definitions": {

        "namespace": { "type": "string" },

        "time": {
            "type": "number",
            "description": "A time value, in seconds.",
            "minimum": 0.0
        },

        "frequency": {
            "type": "number",
            "description": "A frequency value, in Hertz.",
            "minimum": 0.0,
            "exclusiveMinimum": true
        },

        "bounded_magnitude": {
            "type": "number",
            "description": "A unitless value, in the range of [0, 1].",
            "minimum": 0.0,
            "maximum": 1.0
        },

        "interval": {
            "type": "object",
            "properties": {
                "type": { "enum": [ "interval" ] },
                "time": { "$ref": "#/definitions/time" },
                "duration": { "$ref": "#/definitions/time" },
                "value": {
                    "oneOf": [
                        { "type": "string" },
                        { "type": "number" },
                        { "type": "integer" }
                    ]
                },
                "confidence": { "$ref": "#/definitions/bounded_magnitude" },
                "namespace": { "$ref": "#/definitions/namespace" }
            },
            "required": ["type", "time", "duration", "value", "namespace"],
            "additionalProperties": false
        },

        "series": {
            "type": "object",
            "description": "",
            "properties": {
                "type": { "enum": [ "series" ] },
                "time": { "$ref": "#/definitions/time" },
                "duration": { "$ref": "#/definitions/time" },
                "values": {
                    "type": "array",
                    "items": {
                        "oneOf": [
                            { "type": "string" },
                            { "type": "number" },
                            { "type": "integer" }
                        ]
                    },
                    "minItems": 1
                },
                "confidence": { "$ref": "#/definitions/bounded_magnitude" },
                "namespace": { "$ref": "#/definitions/namespace" }
            },
            "required": ["type", "time", "duration", "values", "namespace"],
            "additionalProperties": false
        },

        "observation_set": {
            "type": "array",
            "title": "Observation set",
            "description": "Container for a collection of observations.",
            "items": {
                "anyOf": [
                    { "$ref": "#/definitions/interval" },
                    { "$ref": "#/definitions/series" }
                ]
            },
            "minItems": 1,
            "uniqueItems": true
        },

        "file_metadata": {
            "type": "object",
            "title": "File Metadata",
            "properties": {
                "identifiers": {
                    "type": "object",
                    "title": "Namespace Identifiers",
                    "description": "Sandbox for file ID information (e.g. echonest ID, musicbrainz ID, etc.)."
                },
                "artist": { "type": "string"},
                "title": { "type": "string"},
                "release": { "type": "string"},
                "duration": { "$ref": "#/definitions/time" }
            },
            "additionalProperties": false
        },

        "curator": {
            "type": "object",
            "title": "Curator",
            "description": "Curator contact information: name and email",
            "properties": {
                "name": { "type": "string"},
                "email": { "type": "string", "format": "email" }
            },
            "required": ["name", "email"],
            "additionalProperties": false
        },

        "annotation_metadata": {
            "type": "object",
            "title": "Annotation metadata",
            "description": "All metadata required to describe an annotation",
            "properties": {
                "corpus": { "type": "string" },
                "version": { "type": "string" },
                "curator": { "$ref": "#/definitions/curator" },
                "annotator": {
                    "type": "object",
                    "title": "Annotator",
                    "description": "Sandbox for information about the annotator."
                },
                "annotation_tools": { "type": "string"},
                "annotation_rules": { "type": "string"},
                "validation": { "type": "string"},
                "data_source": { "type": "string"}
            },
            "required": ["version", "curator"],
            "additionalProperties": false
        },

        "annotation": {
            "type": "object",
            "title": "Annotation",
            "description": "An annotation by a single observer.",
            "properties": {
                "annotation_metadata": { "$ref": "#/definitions/annotation_metadata" },
                "observations": { "$ref": "#/definitions/observation_set" },
                "sandbox": { "type": "object"}
            },
            "required": ["annotation_metadata", "observations"],
            "additionalProperties": false
        }

    },

    "type": "object",
    "title": "JAMS file",
    "description": "JSON Annotated Music Specification",
    "properties": {
        "file_metadata": { "$ref": "#/definitions/file_metadata" },
        "jams_version" : { "type": "string", "pattern": "[0-9].[0-9].[0-9]"},
        "annotations": {
            "type": "array",
            "title": "Annotations",
            "description": "All annotations for this file",
            "items": { "$ref": "#/definitions/annotation" },
            "minItems": 1,
            "uniqueItems": true
        },
        "sandbox": { "type": "object" }
    },
    "required": ["file_metadata", "jams_version"]
}
