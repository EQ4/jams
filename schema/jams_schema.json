{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "id": "#root",

    "definitions": {

        "FileMetadata": {
            "type": "object",
            "title": "File Metadata",
            "properties": {
                "identifiers": {
                    "type": "object",
                    "title": "Namespace Identifiers",
                    "description": "Sandbox for file ID information (e.g. echonest ID, musicbrainz ID, etc.)."
                },
                "artist": { "type": "string"},
                "title": { "type": "string"},
                "release": { "type": "string"},
                "duration": { "type": "string", "pattern": "[0-9][0-9]:[0-9][0-9]:[0-9][0-9]"},
                "jams_version" : { "type": "string", "pattern": "[0-9].[0-9].[0-9]"}
            }
        },

        "Curator": {
            "type": "object",
            "title": "Curator",
            "description": "Curator contact information: name and email",
            "properties": {
                "name": { "type": "string"},
                "email": { "type": "string", "format": "email" }
            },
            "required": ["name", "email"]
        },

        "AnnotationMetadata": {
            "type": "object",
            "title": "Annotation metadata",
            "description": "All metadata required to describe an annotation",
            "properties": {
                "corpus": { "type": "string" },
                "version": { "type": ["string", "number"] },
                "curator": { "$ref": "#/definitions/Curator" },
                "annotator": {
                    "type": "object",
                    "title": "Annotator",
                    "description": "Sandbox for information about the annotator."
                },
                "annotation_tools": { "type": "string"},
                "annotation_rules": { "type": "string"},
                "validation": { "type": "string"},
                "data_source": { "type": "string"}
            },
            "required": ["version", "curator"]
        },

        "SparseObservation": {
            "type": "object",
            "title": "SparseObservation",
            "description": "An observation that spans an interval of time",
            "properties": {
                "value": {"type": ["number", "string", "boolean"] },
                "confidence": {"type": "number" },
                "time": {"type": "number", 
                         "minimum": 0.0},
                "duration": {"type": "number",
                             "minimum": 0.0}
            },
            "required": ["value", "time", "duration", "confidence"]
        },

        "DenseObservation": {
            "type": "object",
            "title": "DenseObservation",
            "description": "A dense series of observations",
            "properties": {
                "value": {"type": "array", 
                          "items": {"type": "object" }},

                "confidence": {"type": "array", 
                               "items": {"type": "number"}},

                "time": {"type": "array", 
                         "items": { "type": "number", 
                                    "minimum": 0.0 }},

                "duration": {"type": "array", 
                             "items": { "type": "number",
                                        "minimum": 0.0 }}
            },
            "required": ["value", "time", "duration", "confidence"]
        },

        "ObservationAnnotation": {
            "id": "#observation-annotation",
            "type": "object",
            "title": "Observation Annotation",
            "description": "An annotation of a single observation, e.g. tags",
            "properties": {
                "annotation_metadata": { "$ref": "#/definitions/AnnotationMetadata" },
                "data": {
                    "type": "array",
                    "title": "Data",
                    "description": "An array of observations",
                    "items": { "$ref": ["#/definitions/SparseObservation",
                                        "#/definitions/DenseObservation" ]}
                },
                "sandbox": { "type": "object"}
            },
            "required": ["annotation_metadata", "data"]
        }

    },

    "type": "object",
    "title": "JAMS file",
    "description": "JSON Annotated Music Specification",
    "properties": {

        "file_metadata": { "$ref": "#/definitions/FileMetadata" },

        "genre": {
            "type": "array",
            "title": "Genre",
            "description": "Genre annotations",
            "items": { "$ref": "#/definitions/ObservationAnnotation" }
        },

        "mood": {
            "type": "array",
            "title": "Mood",
            "description": "Mood annotations",
            "items": { "$ref": "#/definitions/ObservationAnnotation" }
        },

        "tag": {
            "type": "array",
            "title": "Tag",
            "description": "Semantic tag annotations",
            "items": { "$ref": "#/definitions/ObservationAnnotation" }
        },

        "beat": {
            "type": "array",
            "title": "Beats",
            "description": "Beat annotations",
            "items": { "$ref": "#/definitions/ObservationAnnotation" }
        },

        "onset": {
            "type": "array",
            "title": "Onsets",
            "description": "Onset annotations",
            "items": { "$ref": "#/definitions/ObservationAnnotation" }
        },

        "chord": {
            "type": "array",
            "title": "Chords",
            "description": "Chord annotations",
            "items": { "$ref": "#/definitions/ObservationAnnotation" }
        },

        "key": {
            "type": "array",
            "title": "key",
            "description": "Key annotations",
            "items": { "$ref": "#/definitions/ObservationAnnotation" }
        },

        "segment": {
            "type": "array",
            "title": "Segment",
            "description": "Structural segmentation annotations",
            "items": { "$ref": "#/definitions/ObservationAnnotation" }
        },

        "source": {
            "type": "array",
            "title": "Source",
            "description": "Source activation annotations",
            "items": { "$ref": "#/definitions/ObservationAnnotation" }
        },

        "note": {
            "type": "array",
            "title": "Notes",
            "description": "Notes (symbolic) annotations",
            "items": { "$ref": "#/definitions/ObservationAnnotation" }
        },

        "melody": {
            "type": "array",
            "title": "Melody",
            "description": "Melody (continuous predominant f0) annotations",
            "items": { "$ref": "#/definitions/ObservationAnnotation" }
        },

        "pitch": {
            "type": "array",
            "title": "Pitch",
            "description": "Pitch (continuous f0) annotations",
            "items": { "$ref": "#/definitions/ObservationAnnotation" }
        },

        "pattern": {
            "type": "array",
            "title": "Patterns",
            "description": "Pattern annotations",
            "items": { "$ref": "#/definitions/ObservationAnnotation" }
        },

        "sandbox": { "type": "object" }
    }
}
